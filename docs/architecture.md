# Nomad CSS アーキテクチャと実装方針

## プロジェクト理念
Nomad CSSは、特定のフレームワークに依存しない、純粋なCSS（SCSS）ライブラリです。
「**Core（構造）**」、「**Contract（契約・共通バリエーション）**」、「**Theme（見た目）**」の3層構造を採用し、堅牢なコンポーネント設計と柔軟なテーマ切り替えを両立させています。

## アーキテクチャ階層

### 1. Core層 (`src/components/`)
コンポーネントの「機能」と「最低限の構造」のみを定義します。
- **役割**: レイアウト、基本動作（hover/focus/disabled）、アクセシビリティ（focus-visible等）。
- **特徴**: 
    -具体的な色（hex/hsl）や装飾的なスタイル（影、角丸の大きさ）を直接持たない。
    - すべてCSS変数（Custom Properties）で定義する。
    - バリエーションクラス（`.filled`や`.outlined`など）を持たない（Baseのみ）。

### 2. Contract層 (`src/themes/contract/`)
テーマ間で共通する「振る舞い」や「バリエーション」を定義する中間層です。
- **役割**: 
    - 各コンポーネントの標準バリエーション（Variant）の実装。
    - 共通のトークン定義（HUE色相環、セマンティックカラーの計算ロジック）。
- **実装内容**:
    - `.button.filled`, `.input-underline` などのバリエーションクラスはここで定義されます。
    - これにより、Fluent2やMaterial3などの個別テーマは、バリエーションごとのCSSを再実装する必要がなく、変数の上書きだけで済むようになります。

### 3. Theme層 (`src/themes/fluent2/`, `src/themes/material3/`)
具体的なデザインシステム（ルック＆フィール）を適用する層です。
- **役割**:
    - CoreやContractで定義されたCSS変数を、特定のデザインシステムに合わせて上書きする。
    - HTML構造を変更せず、CSS変数の値を変更するだけで見た目を激変させる。
- **実装例**:
    - Material 3ではボタンの角丸を `20px` に、Fluent 2では `4px` に設定する。
    - `input` の高さを Material 3では `56px`、Fluent 2では `32px` にする。

## 実装における重要な決定事項

### コンポーネントバリエーションの管理
当初はCore層にバリエーション（Filled, Outlined等）を持たせていましたが、設計を見直し、**Contract層に移動**しました。
- **理由**: バリエーションの実装自体がデザインシステムによって微妙に異なる場合があるため、Coreは純粋な構造のみに保ち、共通項をContractで管理するほうが柔軟性が高いため。

### 詳細度（Specificity）の管理
ThemeやContractからの上書きを確実にするため、詳細度の管理を徹底しています。
- 例: 下線スタイル（Underline Variant）において、Baseスタイルのボーダーを打ち消すために、Contract層では `.input.input-underline` のようにクラスを連結して詳細度を高めています。

### CSS変数の命名規則
- `prefix` を活用し、各コンポーネント固有の変数を定義（例: `--nomad-button-bg`）。
- テーマ層ではこれらの変数を、パレット変数（`--nomad-palette-blue-500`等）にマッピングします。

## 今後の拡張方針
新しいコンポーネントやテーマを追加する際は、以下のステップを踏みます。
1. **Core**: 構造のみを作成し、全てのプロパティをCSS変数化する。
2. **Contract**: 必要であれば汎用的なバリエーションを追加する。
3. **Theme**: 新しいテーマファイル（`_newtheme.scss`）を作成し、変数を定義する。
